select distinct id, from (select id,bill_type,item_num_id,qty_change,p_qty_change,sid,operate_type,count(1) count from u_goods_stock_log  where bill_type=5 group by id,item_num_id,qty_change,p_qty_change,sid,bill_type,operate_type having count(1)>1) a;


select id,bill_type,item_num_id,qty_change,p_qty_change,sid,operate_type,count(1) count from u_goods_stock_log  where bill_type=5 group by id,item_num_id,qty_change,p_qty_change,sid,bill_type,operate_type having count(1)>1

MMH2019011110022599  多1次
MMH2019012010026154  多7次
MMH2019012010026161  多7次




select * from u_stock_log_his where id='MMH2019011110022599';

select * from u_stock_log where id='MMH2019011110022599';

#确认误操作之后有无盘点
select * from u_stock_log where to_sid=1500000115 and bill_type=5;
select * from u_stock_log_detail where id='MMH2019011110022599'; --无





create table wgn_gb_stock_MMH2019011110022599 as select * from t_gb_stock a where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);

update t_gb_stock a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190111 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190112 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190113 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190114 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190115 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190111 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190116 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);

update t_gb_stock_20190117 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190118 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);

update t_gb_stock_20190119 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);


update t_gb_stock_20190120 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);





-----------------------------

select * from u_stock_log where id='MMH2019012010026154';  
select * from u_stock_log where to_sid=1500000147 and bill_type=5; --无

select * from u_stock_log_detail where id='MMH2019012010026154';

create table wgn_gb_stock_MMH2019012010026154 as select * from t_gb_stock a where a.shop_id=1500000147 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026154');

update t_gb_stock a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000147 and id='MMH2019012010026154' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*7)
where a.shop_id=1500000147 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026154');

update t_gb_stock_20190120 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000147 and id='MMH2019012010026154' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*7)
where a.shop_id=1500000147 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026154');


select * from u_goods_stock_log where id='MMH2019012010026154' and item_num_id=717592;


select * from u_goods_stock_log where  sid=1500000147  and item_num_id=717592;
select * from t_gb_stock where shop_id=1500000147  and item_num_id=717592;

select * from u_stock_log_detail 




------------------------------------------



select * from u_stock_log where id='MMH2019012010026161';
select * from u_stock_log where to_sid=1500000110 and bill_type=5; --无

select * from u_stock_log_detail where id='MMH2019012010026161';

create table wgn_gb_stock_MMH2019012010026161 as select * from t_gb_stock a where a.shop_id=1500000110 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');

update t_gb_stock a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000110 and id='MMH2019012010026161' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*7)
where a.shop_id=1500000110 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');

update t_gb_stock_20190120 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000110 and id='MMH2019012010026161' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*7)
where a.shop_id=1500000110 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');


select * from u_goods_stock_log where id='MMH2019012010026161' and item_num_id=1100000070;
select * from u_goods_stock_log where  sid=1500000110  and item_num_id=1100000070;
select * from t_gb_stock where shop_id=1500000110  and item_num_id=1100000070;

select * from u_stock_log_detail 




create table  wgn_goods_stock_log_20190121_all as 
select * from u_goods_stock_log;

delete from u_goods_stock_log where id in ('MMH2019011110022599','MMH2019012010026154','MMH2019012010026161') and seq_id not in (
'490376',
'490377',
'583168',
'583169',
'583170',
'583171',
'583172',
'583173',
'583174',
'583175',
'583176',
'583177',
'583178',
'583179',
'583180',
'583181',
'583182',
'583183',
'583184',
'583185',
'583186',
'583187',
'583188',
'583189',
'583190',
'583191',
'583192',
'583193',
'583194',
'583195',
'583196',
'583197',
'583198',
'583199',
'583200',
'583201',
'583202',
'583203',
'583204',
'583205',
'583206',
'583207',
'583208',
'583209',
'583210',
'583211',
'583212',
'583213',
'583214',
'583215',
'583216',
'583217',
'583218',
'583219',
'583220',
'583221',
'583222',
'583223',
'583224',
'583225',
'583226',
'583227',
'583228',
'583229',
'583230',
'583231',
'583232',
'583233',
'583234',
'583235',
'583236',
'583237',
'583238',
'583239',
'583240',
'583241',
'583242',
'583243',
'583244',
'583245',
'583246',
'583247',
'583248',
'583249',
'583250',
'583251',
'583252',
'583253',
'583254',
'583255',
'583256',
'583257',
'583258',
'583259',
'583260',
'583261',
'583262',
'583263',
'583264',
'583265',
'583266',
'583267',
'583268',
'583269',
'583270',
'583271',
'583272',
'583273',
'583274',
'583275',
'583276',
'583277',
'583278',
'583279',
'583280',
'583281',
'583282',
'583283',
'583284',
'583285',
'583286',
'583287',
'583288',
'583289',
'583290',
'583291',
'583292',
'583293',
'583294',
'583295',
'583296',
'583297',
'583298',
'583299',
'583300',
'583301',
'583302',
'583303',
'583304',
'583305',
'583306',
'583307',
'583308',
'583309',
'583310',
'583311',
'583312',
'583313',
'583314',
'583315',
'583316',
'583317',
'583318',
'583319',
'583320',
'583321',
'583322',
'583323',
'583324',
'583325',
'583326',
'583327',
'583328',
'583329',
'583330',
'583331',
'583332',
'583333',
'583334',
'583335',
'583336',
'583337',
'583338',
'583339',
'583340',
'583341',
'583342',
'583343',
'583344',
'583345',
'583346',
'583347',
'583348',
'583349',
'583350',
'583351',
'583352',
'583353',
'583354',
'583355',
'583356',
'583357',
'583358',
'583359',
'583360',
'583361',
'583362',
'583363',
'583364',
'583365',
'583366',
'583367',
'583368',
'583369',
'583370',
'583371',
'583372',
'583373',
'583374',
'583375',
'583376',
'583377',
'583378',
'583379',
'583380',
'583381',
'583382',
'583383',
'583384',
'583385',
'583386',
'583387',
'583388',
'583389',
'583390',
'583391',
'583392',
'583393',
'583394',
'583395',
'583396',
'583397',
'583398',
'583399',
'583400',
'583401',
'583402',
'583403',
'583404',
'583405',
'583406',
'583407',
'583408',
'583409',
'583410',
'583411',
'583412',
'583413',
'583414',
'583415',
'583416',
'583417',
'583418',
'583419',
'583420',
'583421',
'583422',
'583423',
'583424',
'583425',
'583426',
'583427',
'583428',
'583429',
'583430',
'583431',
'583432',
'583433',
'583434',
'583435',
'583436',
'583437',
'583438',
'583439',
'583440',
'583441',
'583442',
'583443',
'583444',
'583445',
'583446',
'583447',
'583448',
'583449',
'583450',
'583451',
'583452',
'583453',
'583454',
'583455',
'583456',
'583457',
'583458',
'583459',
'583460',
'583461',
'583462',
'583463',
'583464',
'583465',
'583466',
'583467',
'583468',
'583469',
'583470',
'583471',
'583472',
'583473',
'583474',
'583475',
'583476',
'583477',
'583478',
'583479',
'583480',
'583481',
'583482',
'583483',
'583484',
'583485',
'583486',
'583487',
'583488',
'583489',
'583490',
'583491',
'583492',
'583493',
'583494',
'583495',
'583496',
'583497',
'583498',
'583499',
'583500',
'583501',
'583502',
'583503',
'583504',
'583505',
'583506',
'583507',
'583508',
'583509',
'583510',
'583511',
'583512',
'583513',
'583514',
'583515',
'583516',
'583517',
'583518',
'583519',
'583520',
'583521',
'583522',
'583523',
'583524',
'583525',
'583526',
'583527',
'583528',
'583529',
'583530',
'583531',
'583532',
'583533',
'583534',
'583535',
'583536',
'583537',
'583538',
'583539',
'583540',
'583541',
'583542',
'583543',
'583544',
'583545',
'583546',
'583547',
'583548',
'583549',
'583550',
'583551',
'583552',
'583553',
'583554',
'583555',
'583556',
'583557',
'583558',
'583559',
'583560',
'583561',
'583562',
'583563',
'583564',
'583565',
'583566',
'583567',
'583568',
'583569',
'583570',
'583571',
'583572',
'583573',
'583574',
'583575',
'583576',
'583577',
'583578',
'583579',
'583580',
'583581',
'583582',
'583583',
'583584',
'583585',
'583586',
'583587',
'583588',
'583589',
'583590',
'583591',
'583592',
'583593',
'583594',
'583595',
'583596',
'583597',
'583598',
'583599',
'583600',
'583601',
'583602',
'583603',
'583604',
'583605',
'583606',
'583607',
'583608',
'583609',
'583610',
'583611',
'583612',
'583613',
'583614',
'583615',
'583616',
'583617',
'583618',
'583619',
'583620',
'583621',
'583622',
'583623',
'583624',
'583625',
'583626',
'583627',
'583628',
'583629',
'583630',
'583631',
'583632',
'583633',
'583634',
'583635',
'583636',
'583637',
'583638',
'583639',
'583640',
'583641',
'583642',
'583643',
'583644',
'583645',
'583646',
'583647',
'583648',
'583649',
'583650',
'583651',
'583652',
'583653',
'583654',
'583655',
'583656',
'583657',
'583658',
'583659',
'583660',
'583661',
'583662',
'583663',
'583664',
'583665',
'583666',
'583667',
'583668',
'583669',
'583670',
'583671',
'583672',
'583673',
'583674',
'583675',
'583676',
'583677',
'583678',
'583679',
'583680',
'583681',
'583682',
'583683',
'583684',
'583685',
'583686',
'583687',
'583688',
'583689',
'583690',
'583691',
'583692',
'583693',
'583694',
'583695',
'583696',
'583697',
'583698',
'583699',
'583700',
'583701',
'583702',
'583703',
'583704',
'583705',
'583706',
'583707',
'583708',
'583709',
'583710',
'583711',
'583712',
'583713',
'583714',
'583715',
'583716',
'583717',
'583718',
'583719',
'583720',
'583721',
'583722',
'583723',
'583724',
'583725',
'583726',
'583727',
'583728',
'583729',
'583730',
'583731',
'583732',
'583733',
'583734',
'583735',
'583736',
'583737',
'583738',
'583739',
'583740',
'583741',
'583742',
'583743',
'583744',
'583745',
'583746',
'583747',
'583748',
'583749',
'583750',
'583751',
'583752',
'583753',
'583754',
'583755',
'583756',
'583757',
'583758',
'583759',
'583760',
'583761',
'583762',
'583763',
'583764',
'583765',
'583766',
'583767',
'583768',
'583769',
'583770',
'583771',
'583772',
'583773',
'583774',
'583775',
'583776',
'583777',
'583778',
'583779',
'583780',
'583781',
'583782',
'583783',
'583784',
'583785',
'583786',
'583787',
'583788',
'583789',
'583790',
'583791',
'583792',
'583793',
'583794',
'583795',
'583796',
'583797',
'583798',
'583799',
'583800',
'583801',
'583802',
'583803',
'583804',
'583805',
'583806',
'583807',
'583808',
'583809',
'583810',
'583811',
'583812',
'583813',
'583814',
'583815',
'583816',
'583817',
'583818',
'583819',
'583820',
'583821',
'583822',
'583823',
'583824',
'583825',
'583826',
'583827',
'583828',
'583829',
'583830',
'583831',
'583832',
'583833',
'583834',
'583835',
'583836',
'583837',
'583838',
'583839',
'583840',
'583841',
'583842',
'583843',
'583844',
'583845',
'583846',
'583847',
'583848',
'583849',
'583850',
'583851',
'583852',
'583853',
'583854',
'583855',
'583856',
'583857',
'583858',
'583859',
'583860',
'583861',
'583862',
'583863',
'583864',
'583865',
'583866',
'583867',
'583868',
'583869',
'583870',
'583871',
'583872',
'583873',
'583874',
'583875',
'583876',
'583877',
'583878',
'583879',
'583880',
'583881',
'583882',
'583883',
'583884',
'583885',
'583886',
'583887',
'583888',
'583889',
'583890',
'583891',
'583892',
'583893',
'583894',
'583895',
'583896',
'583897',
'583898',
'583899',
'583900',
'583901',
'583902',
'583903',
'583904',
'583905',
'583906',
'583907',
'583908',
'583909',
'583910',
'583911',
'583912',
'583913',
'583914',
'583915',
'583916',
'583917',
'583918',
'583919',
'583920',
'583921',
'583922',
'583923',
'583924',
'583925',
'583926',
'583927',
'583928',
'583929',
'583930',
'583931',
'583932',
'583933',
'583934',
'583935',
'583936',
'583937',
'583938',
'583939',
'583940',
'583941',
'583942',
'583943',
'583944',
'583945',
'583946',
'583947',
'583948',
'583949',
'583950',
'583951',
'583952',
'583953',
'583954',
'583955',
'583956',
'583957',
'583958',
'583959',
'583960',
'583961',
'583962',
'583963',
'583964',
'583965',
'583966',
'583967',
'583968',
'583969',
'583970',
'583971',
'583972',
'583973',
'583974',
'583975',
'583976',
'583977',
'583978',
'583979',
'583980',
'583981',
'583982',
'583983',
'583984',
'583985',
'583986',
'583987',
'583988',
'583989',
'583990',
'583991',
'583992',
'583993',
'583994',
'583995',
'583996',
'583997',
'583998',
'583999',
'584000',
'584001',
'584002',
'584003',
'584004',
'584005',
'584006',
'584007',
'584008',
'584009',
'584010',
'584011',
'584012',
'584013',
'584014',
'584015',
'584016',
'584017',
'584018',
'584019',
'584020',
'584021',
'584022',
'584023',
'584024',
'584025',
'584026',
'584027',
'584028',
'584029',
'584030',
'584031',
'584032',
'584033',
'584034',
'584035',
'584036',
'584037',
'584038',
'584039',
'584040',
'584041',
'584042',
'584043',
'584044',
'584045',
'584046',
'584047',
'584048',
'584049',
'584050',
'584051',
'584052',
'584053',
'584054',
'584055',
'584056',
'584057',
'584058',
'584059',
'584060',
'584061',
'584062',
'584063',
'584064',
'584065',
'584066',
'584067',
'584068',
'584069',
'584070',
'584071',
'584072',
'584073',
'584074',
'584075',
'584076',
'584077',
'584078',
'584079',
'584080',
'584081',
'584082',
'584083',
'584084',
'584085',
'584086',
'584087',
'584088',
'584089',
'584090',
'584091',
'584092',
'584093',
'584094',
'584095',
'584096',
'584097',
'584098',
'584099',
'584100',
'584101',
'584102',
'584103',
'584104',
'584105',
'584106',
'584107',
'584108',
'584109',
'584110',
'584111',
'584112',
'584113',
'584114',
'584115',
'584116',
'584117',
'584118',
'584119',
'584120',
'584121',
'584122',
'584123',
'584124',
'584125',
'584126',
'584127',
'584128',
'584129',
'584130',
'584131',
'584132',
'584133',
'584134',
'584135',
'584136',
'584137',
'584138',
'584139',
'584140',
'584141',
'584142',
'584143',
'584144',
'584145',
'584146',
'584147',
'584148',
'584149',
'584150',
'584151',
'584152',
'584153',
'584154',
'584155',
'584156',
'584157',
'584158',
'584159',
'584160',
'584161',
'584162',
'584163',
'584164',
'584165',
'584166',
'584167',
'584168',
'584169',
'584170',
'584171',
'584172',
'584173',
'584174',
'584175',
'584176',
'584177',
'584178',
'584179',
'584180',
'584181',
'584182',
'584183',
'584184',
'584185',
'584186',
'584187',
'584188',
'584189',
'584190',
'584191',
'584192',
'584193',
'584194',
'584195',
'584196',
'584197',
'584198',
'584199',
'584200',
'584201',
'584202',
'584203',
'584204',
'584205',
'584206',
'584207',
'584208',
'584209',
'584210',
'584211',
'584212',
'584213',
'584214',
'584215',
'584216',
'584217',
'584218',
'584219',
'584220',
'584221',
'584222',
'584223',
'584224',
'584225',
'584226',
'584227',
'584228',
'584229',
'584230',
'584231',
'584232',
'584233',
'584234',
'584235',
'584236',
'584237',
'584238',
'584239',
'584240',
'584241',
'584242',
'584243',
'584244',
'584245',
'584246',
'584247',
'584248',
'584249',
'584250',
'584251',
'584252',
'584253',
'584254',
'584255',
'584256',
'584257',
'584258',
'584259',
'584260',
'584261',
'584262',
'584263',
'584264',
'584265',
'584266',
'584267',
'584268',
'584269',
'584270',
'584271',
'584272',
'584273',
'584274',
'584275',
'584276',
'584277',
'584278',
'584279',
'584280',
'584281',
'584282',
'584283',
'584284',
'584285',
'584286',
'584287',
'584288',
'584289',
'584290',
'584291',
'584292',
'584293',
'584294',
'584295',
'584296',
'584297',
'584298',
'584299',
'584300',
'584301',
'584302',
'584303',
'584304',
'584305',
'584306',
'584307',
'584308',
'584309',
'584310',
'584311',
'584312',
'584313',
'584314',
'584315',
'584316',
'584317',
'584318',
'584319',
'584320',
'584321',
'584322',
'584323',
'584324',
'584325',
'584326',
'584327',
'584328',
'584329',
'584330',
'584331',
'584332',
'584333',
'584334',
'584335',
'584336',
'584337',
'584338',
'584339',
'584340',
'584341',
'584342',
'584343',
'584344',
'584345',
'584346',
'584347',
'584348',
'584349',
'584350',
'584351',
'584352',
'584353',
'584354',
'584355',
'584356',
'584357',
'584358',
'584359',
'584360',
'584361',
'584362',
'584363',
'584364',
'584365',
'584366',
'584367',
'584368',
'584369',
'584370',
'584371',
'584372',
'584373',
'584374',
'584375',
'584376',
'584377',
'584378',
'584379',
'584380',
'584381',
'584382',
'584383',
'584384',
'584385',
'584386',
'584387',
'584388',
'584389',
'584390',
'584391',
'584392',
'584393',
'584394',
'584395',
'584396',
'584397',
'584398',
'584399',
'584400',
'584401',
'584402',
'584403',
'584404',
'584405',
'584406',
'584407',
'584408',
'584409',
'584410',
'584411',
'584412',
'584413',
'584414',
'584415',
'584416',
'584417',
'584418',
'584419',
'584420',
'584421',
'584422',
'584423',
'584424',
'584425',
'584426',
'584427',
'584428',
'584429',
'584430',
'584431',
'584432',
'584433',
'584434',
'584435',
'584436',
'584437',
'584438',
'584439',
'584440',
'584441',
'584442',
'584443',
'584444',
'584445',
'584446',
'584447',
'584448',
'584449',
'584450',
'584451',
'584452',
'584453',
'584454',
'584455',
'584456',
'584457',
'584458',
'584459',
'584460',
'584461',
'584462',
'584463',
'584464',
'584465',
'584466',
'584467',
'584468',
'584469',
'584470',
'584471',
'584472',
'584473',
'584474',
'584475',
'584476',
'584477',
'584478',
'584479',
'584480',
'584481',
'584482',
'584483',
'584484',
'584485',
'584486',
'584487',
'584488',
'584489',
'584490',
'584491',
'584492',
'584493',
'584494',
'584495',
'584496',
'584497',
'584498',
'584499',
'584500',
'584501',
'584502',
'584503',
'584504',
'594385',
'594386',
'594387',
'594388',
'594389',
'594390',
'594391',
'594392',
'594393',
'594394',
'594395',
'594396',
'594397',
'594398',
'594399',
'594400',
'594401',
'594402',
'594403',
'594404',
'594405',
'594406',
'594407',
'594408',
'594409',
'594410',
'594411',
'594412',
'594413',
'594414',
'594415',
'594416',
'594417',
'594418',
'594419',
'594420',
'594421',
'594422',
'594423',
'594424',
'594425',
'594426',
'594427',
'594428',
'594429',
'594430',
'594431',
'594432',
'594433',
'594434',
'594435',
'594436',
'594437',
'594438',
'594439',
'594440',
'594441',
'594442',
'594443',
'594444',
'594445',
'594446',
'594447',
'594448',
'594449',
'594450',
'594451',
'594452',
'594453',
'594454',
'594455',
'594456',
'594457',
'594458',
'594459',
'594460',
'594461',
'594462',
'594463',
'594464',
'594465',
'594466',
'594467',
'594468',
'594469',
'594470',
'594471',
'594472',
'594473',
'594474',
'594475',
'594476',
'594477',
'594478',
'594479',
'594480',
'594481',
'594482',
'594483',
'594484',
'594485',
'594486',
'594487',
'594488',
'594489',
'594490',
'594491',
'594492',
'594493',
'594494',
'594495',
'594496',
'594497',
'594498',
'594499',
'594500',
'594501',
'594502',
'594503',
'594504',
'594505',
'594506',
'594507',
'594508',
'594509',
'594510',
'594511',
'594512',
'594513',
'594514',
'594515',
'594516',
'594517',
'594518',
'594519',
'594520',
'594521',
'594522',
'594523',
'594524',
'594525',
'594526',
'594527',
'594528',
'594529',
'594530',
'594531',
'594532',
'594533',
'594534',
'594535',
'594536',
'594537',
'594538',
'594539',
'594540',
'594541',
'594542',
'594543',
'594544',
'594545',
'594546',
'594547',
'594548',
'594549',
'594550',
'594551',
'594552',
'594553',
'594554',
'594555',
'594556',
'594557',
'594558',
'594559',
'594560',
'594561',
'594562',
'594563',
'594564',
'594565',
'594566',
'594567',
'594568',
'594569',
'594570',
'594571',
'594572',
'594573',
'594574',
'594575',
'594576',
'594577',
'594578',
'594579',
'594580',
'594581',
'594582',
'594583',
'594584',
'594585',
'594586',
'594587',
'594588',
'594589',
'594590',
'594591',
'594592',
'594593',
'594594',
'594595',
'594596',
'594597',
'594598',
'594599',
'594600',
'594601',
'594602',
'594603',
'594604',
'594605',
'594606',
'594607',
'594608',
'594609',
'594610',
'594611',
'594612',
'594613',
'594614',
'594615',
'594616',
'594617',
'594618',
'594619',
'594620',
'594621',
'594622',
'594623',
'594624',
'594625',
'594626',
'594627',
'594628',
'594629',
'594630',
'594631',
'594632',
'594633',
'594634',
'594635',
'594636',
'594637',
'594638',
'594639',
'594640',
'594641',
'594642',
'594643',
'594644',
'594645',
'594646',
'594647',
'594648',
'594649',
'594650',
'594651',
'594652',
'594653',
'594654',
'594655',
'594656',
'594657',
'594658',
'594659',
'594660',
'594661',
'594662',
'594663',
'594664',
'594665',
'594666',
'594667',
'594668',
'594669',
'594670',
'594671',
'594672',
'594673',
'594674',
'594675',
'594676',
'594677',
'594678',
'594679',
'594680',
'594681',
'594682',
'594683',
'594684',
'594685',
'594686',
'594687',
'594688',
'594689',
'594690',
'594691',
'594692',
'594693',
'594694',
'594695',
'594696',
'594697',
'594698',
'594699',
'594700',
'594701',
'594702',
'594703',
'594704',
'594705',
'594706',
'594707',
'594708',
'594709',
'594710',
'594711',
'594712',
'594713',
'594714',
'594715',
'594716',
'594717',
'594718',
'594719',
'594720',
'594721',
'594722',
'594723',
'594724',
'594725',
'594726',
'594727',
'594728',
'594729',
'594730',
'594731',
'594732',
'594733',
'594734',
'594735',
'594736',
'594737',
'594738',
'594739',
'594740',
'594741',
'594742',
'594743',
'594744',
'594745',
'594746',
'594747',
'594748',
'594749',
'594750',
'594751',
'594752',
'594753',
'594754',
'594755',
'594756',
'594757',
'594758',
'594759',
'594760',
'594761',
'594762',
'594763',
'594764',
'594765',
'594766',
'594767',
'594768',
'594769',
'594770',
'594771',
'594772',
'594773',
'594774',
'594775',
'594776',
'594777',
'594778',
'594779',
'594780',
'594781',
'594782',
'594783',
'594784',
'594785',
'594786',
'594787',
'594788',
'594789',
'594790',
'594791',
'594792',
'594793',
'594794',
'594795',
'594796',
'594797',
'594798',
'594799',
'594800',
'594801',
'594802',
'594803',
'594804',
'594805',
'594806',
'594807',
'594808',
'594809',
'594810',
'594811',
'594812',
'594813',
'594814',
'594815',
'594816',
'594817',
'594818',
'594819',
'594820',
'594821',
'594822',
'594823',
'594824',
'594825',
'594826',
'594827',
'594828',
'594829',
'594830',
'594831',
'594832',
'594833',
'594834',
'594835',
'594836',
'594837',
'594838',
'594839',
'594840',
'594841',
'594842',
'594843',
'594844',
'594845',
'594846',
'594847',
'594848',
'594849',
'594850',
'594851',
'594852',
'594853',
'594854',
'594855',
'594856',
'594857',
'594858',
'594859',
'594860',
'594861',
'594862',
'594863',
'594864',
'594865',
'594866',
'594867',
'594868',
'594869',
'594870',
'594871',
'594872',
'594873',
'594874',
'594875',
'594876',
'594877',
'594878',
'594879',
'594880',
'594881',
'594882',
'594883',
'594884',
'594885',
'594886',
'594887',
'594888',
'594889',
'594890',
'594891',
'594892',
'594893',
'594894',
'594895',
'594896',
'594897',
'594898',
'594899',
'594900',
'594901',
'594902',
'594903',
'594904',
'594905',
'594906',
'594907',
'594908',
'594909',
'594910',
'594911',
'594912',
'594913',
'594914',
'594915',
'594916',
'594917',
'594918',
'594919',
'594920',
'594921',
'594922',
'594923',
'594924',
'594925',
'594926',
'594927',
'594928',
'594929',
'594930',
'594931',
'594932',
'594933',
'594934',
'594935',
'594936',
'594937',
'594938',
'594939',
'594940',
'594941',
'594942',
'594943',
'594944',
'594945',
'594946',
'594947',
'594948',
'594949',
'594950',
'594951',
'594952',
'594953',
'594954',
'594955',
'594956',
'594957',
'594958',
'594959',
'594960',
'594961',
'594962',
'594963',
'594964',
'594965',
'594966',
'594967',
'594968',
'594969',
'594970',
'594971',
'594972',
'594973',
'594974',
'594975',
'594976',
'594977',
'594978',
'594979',
'594980',
'594981',
'594982',
'594983',
'594984',
'594985',
'594986',
'594987',
'594988',
'594989',
'594990',
'594991',
'594992',
'594993',
'594994',
'594995',
'594996',
'594997',
'594998',
'594999',
'595000',
'595001',
'595002',
'595003',
'595004',
'595005',
'595006',
'595007',
'595008',
'595009',
'595010',
'595011',
'595012',
'595013',
'595014',
'595015',
'595016',
'595017',
'595018',
'595019',
'595020',
'595021',
'595022',
'595023',
'595024',
'595025',
'595026',
'595027',
'595028',
'595029',
'595030',
'595031',
'595032',
'595033',
'595034',
'595035',
'595036',
'595037',
'595038',
'595039',
'595040',
'595041',
'595042',
'595043',
'595044',
'595045',
'595046',
'595047',
'595048',
'595049',
'595050',
'595051',
'595052',
'595053',
'595054',
'595055',
'595056',
'595057',
'595058',
'595059',
'595060',
'595061',
'595062',
'595063',
'595064',
'595065',
'595066',
'595067',
'595068',
'595069',
'595070',
'595071',
'595072',
'595073',
'595074',
'595075',
'595076',
'595077',
'595078',
'595079',
'595080',
'595081',
'595082',
'595083',
'595084',
'595085',
'595086',
'595087',
'595088',
'595089',
'595090',
'595091',
'595092',
'595093',
'595094',
'595095',
'595096',
'595097',
'595098',
'595099',
'595100',
'595101',
'595102',
'595103',
'595104',
'595105',
'595106',
'595107',
'595108',
'595109',
'595110',
'595111',
'595112',
'595113',
'595114',
'595115',
'595116',
'595117',
'595118',
'595119',
'595120',
'595121',
'595122',
'595123',
'595124',
'595125',
'595126',
'595127',
'595128',
'595129',
'595130',
'595131',
'595132',
'595133',
'595134',
'595135',
'595136',
'595137',
'595138',
'595139',
'595140',
'595141',
'595142',
'595143',
'595144',
'595145',
'595146',
'595147',
'595148',
'595149',
'595150',
'595151',
'595152',
'595153',
'595154',
'595155',
'595156',
'595157',
'595158',
'595159',
'595160',
'595161',
'595162',
'595163',
'595164',
'595165',
'595166',
'595167',
'595168',
'595169',
'595170',
'595171',
'595172',
'595173',
'595174',
'595175',
'595176',
'595177',
'595178',
'595179',
'595180',
'595181',
'595182',
'595183',
'595184',
'595185',
'595186',
'595187',
'595188',
'595189',
'595190',
'595191',
'595192',
'595193',
'595194',
'595195',
'595196',
'595197',
'595198',
'595199',
'595200',
'595201',
'595202',
'595203',
'595204',
'595205',
'595206',
'595207',
'595208',
'595209',
'595210',
'595211',
'595212',
'595213',
'595214',
'595215',
'595216',
'595217',
'595218',
'595219',
'595220',
'595221',
'595222',
'595223',
'595224',
'595225',
'595226',
'595227',
'595228',
'595229',
'595230',
'595231',
'595232',
'595233',
'595234',
'595235',
'595236',
'595237',
'595238',
'595239',
'595240',
'595241',
'595242',
'595243',
'595244',
'595245',
'595246',
'595247',
'595248',
'595249',
'595250',
'595251',
'595252',
'595253',
'595254',
'595255',
'595256',
'595257',
'595258',
'595259',
'595260',
'595261',
'595262',
'595263',
'595264',
'595265',
'595266',
'595267',
'595268',
'595269',
'595270',
'595271',
'595272',
'595273',
'595274',
'595275',
'595276',
'595277',
'595278',
'595279',
'595280',
'595281',
'595282',
'595283',
'595284',
'595285',
'595286',
'595287',
'595288',
'595289',
'595290',
'595291',
'595292',
'595293',
'595294',
'595295',
'595296',
'595297',
'595298',
'595299',
'595300',
'595301',
'595302',
'595303',
'595304',
'595305',
'595306',
'595307',
'595308',
'595309',
'595310',
'595311',
'595312',
'595313',
'595314',
'595315',
'595316',
'595317',
'595318',
'595319',
'595320',
'595321',
'595322',
'595323',
'595324',
'595325',
'595326',
'595327',
'595328',
'595329',
'595330',
'595331',
'595332',
'595333',
'595334',
'595335',
'595336',
'595337',
'595338',
'595339',
'595340',
'595341',
'595342',
'595343',
'595344',
'595345',
'595346',
'595347',
'595348',
'595349',
'595350',
'595351',
'595352',
'595353',
'595354',
'595355',
'595356',
'595357',
'595358',
'595359',
'595360',
'595361',
'595362',
'595363',
'595364',
'595365',
'595366',
'595367',
'595368',
'595369',
'595370',
'595371',
'595372',
'595373',
'595374',
'595375',
'595376',
'595377',
'595378',
'595379',
'595380',
'595381',
'595382',
'595383',
'595384',
'595385',
'595386',
'595387',
'595388',
'595389',
'595390',
'595391',
'595392',
'595393',
'595394',
'595395',
'595396',
'595397',
'595398',
'595399',
'595400',
'595401',
'595402',
'595403',
'595404',
'595405',
'595406',
'595407',
'595408',
'595409',
'595410',
'595411',
'595412',
'595413',
'595414',
'595415',
'595416',
'595417',
'595418',
'595419',
'595420',
'595421',
'595422',
'595423',
'595424',
'595425',
'595426',
'595427',
'595428',
'595429',
'595430',
'595431',
'595432',
'595433',
'595434',
'595435',
'595436',
'595437',
'595438',
'595439',
'595440',
'595441',
'595442',
'595443',
'595444',
'595445',
'595446',
'595447',
'595448',
'595449',
'595450',
'595451',
'595452',
'595453',
'595454',
'595455',
'595456',
'595457',
'595458',
'595459',
'595460',
'595461',
'595462',
'595463',
'595464',
'595465',
'595466',
'595467',
'595468',
'595469',
'595470',
'595471',
'595472',
'595473',
'595474',
'595475',
'595476',
'595477',
'595478',
'595479',
'595480',
'595481',
'595482',
'595483',
'595484',
'595485',
'595486',
'595487',
'595488',
'595489',
'595490',
'595491',
'595492',
'595493',
'595494',
'595495',
'595496',
'595497',
'595498',
'595499',
'595500',
'595501',
'595502',
'595503',
'595504',
'595505',
'595506',
'595507',
'595508',
'595509',
'595510',
'595511',
'595512',
'595513',
'595514',
'595515',
'595516',
'595517',
'595518',
'595519',
'595520',
'595521',
'595522',
'595523',
'595524',
'595525',
'595526',
'595527',
'595528',
'595529',
'595530',
'595531',
'595532',
'595533',
'595534',
'595535',
'595536',
'595537',
'595538',
'595539',
'595540',
'595541',
'595542',
'595543',
'595544',
'595545',
'595546',
'595547',
'595548',
'595549',
'595550',
'595551',
'595552',
'595553',
'595554',
'595555',
'595556',
'595557',
'595558',
'595559',
'595560',
'595561',
'595562',
'595563',
'595564',
'595565',
'595566',
'595567',
'595568',
'595569',
'595570',
'595571',
'595572',
'595573',
'595574',
'595575',
'595576',
'595577',
'595578',
'595579',
'595580',
'595581',
'595582',
'595583',
'595584',
'595585',
'595586',
'595587',
'595588',
'595589',
'595590',
'595591',
'595592',
'595593',
'595594',
'595595',
'595596',
'595597',
'595598',
'595599',
'595600',
'595601',
'595602',
'595603',
'595604',
'595605',
'595606',
'595607',
'595608',
'595609',
'595610',
'595611',
'595612',
'595613',
'595614',
'595615',
'595616',
'595617',
'595618',
'595619',
'595620',
'595621',
'595622',
'595623',
'595624',
'595625',
'595626',
'595627',
'595628',
'595629',
'595630',
'595631',
'595632',
'595633',
'595634',
'595635',
'595636',
'595637',
'595638',
'595639',
'595640',
'595641',
'595642',
'595643',
'595644',
'595645',
'595646',
'595647',
'595648',
'595649',
'595650',
'595651',
'595652',
'595653',
'595654',
'595655',
'595656',
'595657',
'595658',
'595659',
'595660',
'595661',
'595662',
'595663',
'595664',
'595665',
'595666',
'595667',
'595668',
'595669',
'595670',
'595671',
'595672',
'595673',
'595674',
'595675',
'595676',
'595677',
'595678',
'595679',
'595680',
'595681',
'595682',
'595683',
'595684',
'595685',
'595686',
'595687',
'595688',
'595689',
'595690',
'595691',
'595692',
'595693',
'595694',
'595695',
'595696',
'595697',
'595698',
'595699',
'595700',
'595701',
'595702',
'595703',
'595704',
'595705',
'595706',
'595707',
'595708',
'595709',
'595710',
'595711',
'595712',
'595713',
'595714',
'595715',
'595716',
'595717',
'595718',
'595719',
'595720',
'595721',
'595722',
'595723',
'595724',
'595725',
'595726',
'595727',
'595728',
'595729',
'595730',
'595731',
'595732',
'595733',
'595734',
'595735',
'595736',
'595737',
'595738',
'595739',
'595740',
'595741',
'595742',
'595743',
'595744',
'595745',
'595746',
'595747',
'595748',
'595749',
'595750',
'595751',
'595752',
'595753',
'595754',
'595755',
'595756',
'595757',
'595758',
'595759',
'595760',
'595761',
'595762',
'595763',
'595764',
'595765',
'595766',
'595767',
'595768',
'595769',
'595770',
'595771',
'595772',
'595773',
'595774',
'595775',
'595776',
'595777',
'595778',
'595779',
'595780',
'595781',
'595782',
'595783',
'595784',
'595785',
'595786',
'595787',
'595788',
'595789',
'595790',
'595791',
'595792',
'595793',
'595794',
'595795',
'595796',
'595797',
'595798',
'595799',
'595800',
'595801',
'595802',
'595803',
'595804',
'595805',
'595806',
'595807',
'595808',
'595809',
'595810',
'595811',
'595812',
'595813',
'595814',
'595815',
'595816',
'595817',
'595818',
'595819',
'595820',
'595821',
'595822',
'595823',
'595824',
'595825',
'595826',
'595827',
'595828',
'595829',
'595830',
'595831',
'595832',
'595833',
'595834',
'595835',
'595836',
'595837',
'595838');


select  * from u_goods_stock_log where id='MMH2019011110022599';



select count(1) from u_stock_log_detail where id='MMH2019011110022599';



select count(1) from u_stock_log_detail where id='MMH2019012010026154';


select count(1) from u_stock_log_detail where id='MMH2019012010026154';


create table wgn_tmp_20190122_09 as 
select * from wgn_gb_stock_MMH2019012010026154 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000147 and id='MMH2019012010026154' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
where a.shop_id=1500000147 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026154')
and b.id is null;


update t_gb_stock  a inner join wgn_tmp_20190122_09  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;


select * from  t_gb_stock a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000115 and id='MMH2019011110022599' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
set a.qty=a.qty-(b.qty_change*1)
where a.shop_id=1500000115 
and a.item_num_id in (1000001263,1100002663);



create table wgn_tmp_20190122_10 as 
select a.* from  wgn_gb_stock_MMH2019012010026161 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000110 and id='MMH2019012010026161' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
where a.shop_id=1500000110 
and b.id is null 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');


select * from  t_gb_stock a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000110 and id='MMH2019012010026161' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
where a.shop_id=1500000110 
and b.id is null 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');



create table wgn_tmp_20190122_10 as 
select a.* from  wgn_gb_stock_MMH2019012010026161 a left join (
select id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d'),count(1) count from u_goods_stock_log where sid=1500000110 and id='MMH2019012010026161' group by id,sid,item_num_id,qty_change,date_format(create_time,'%y%m%d')
) b
on a.shop_id=b.sid and a.item_num_id=b.item_num_id
where a.shop_id=1500000110 
and b.id is null 
and a.item_num_id in (select item_num_id from u_stock_log_detail where id='MMH2019012010026161');

update t_gb_stock  a inner join wgn_tmp_20190122_10  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;


update t_gb_stock_20190120  a inner join wgn_tmp_20190122_10  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;

update t_gb_stock_20190121  a inner join wgn_tmp_20190122_10  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;


update t_gb_stock_20190120  a inner join wgn_tmp_20190122_09  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;

update t_gb_stock_20190121 a inner join wgn_tmp_20190122_09  b on a.shop_id=b.shop_id and a.item_num_id=b.item_num_id
set a.qty=a.qty+b.qty;